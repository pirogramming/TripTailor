{% extends "base.html" %}
{% load static %}
{% block head %}
  <link rel="stylesheet" href="{% static 'css/routes/edit_route.css' %}?v={% now 'U' %}">
{% endblock %}

{% block content %}
<main>
  <h1>ë£¨íŠ¸ ìˆ˜ì •í•˜ê¸°</h1>
  <div id="form-container">
    <form method="post" action="{% url 'routes:update_route' route.id %}" id="update-route-form">
      {% csrf_token %}
      <input type="hidden" name="from" value="{{ from_page }}">

      <!-- ë£¨íŠ¸ ì œëª© -->
      <div class="form-group">
        <label>ë£¨íŠ¸ ì œëª©</label><br>
        <input type="text" name="title" value="{{ route.title }}" required>
      </div>

      <!-- ìš”ì•½ -->
      <div class="form-group">
        <label>ì§€ì—­ ìš”ì•½</label><br>
        <input type="text" name="location_summary" value="{{ route.location_summary }}">
      </div>

      <!-- ì„¤ëª… -->
      <div class="form-group">
        <label>ì„¤ëª…</label><br>
        <textarea name="description">{{ route.description }}</textarea>
      </div>

      <!-- ëŒ€í‘œ ì´ë¯¸ì§€ URL -->
      <div class="form-group">
        <label>ëŒ€í‘œ ì´ë¯¸ì§€ URL</label><br>
        <input type="url" name="cover_photo_url" value="{{ route.cover_photo_url }}">
      </div>

      <!-- ê³µê°œ ì—¬ë¶€ -->
      <div>
        <label class="checkbox-label">
          <input type="checkbox" name="is_public" value="true" {% if route.is_public %}checked{% endif %}>
          ê³µê°œ ë£¨íŠ¸ë¡œ ì„¤ì •
        </label>
      </div>

      <!-- âœ… ì¥ì†Œ ìˆœì„œë¥¼ ë‹´ì„ hidden input -->
        <input type="hidden" name="place_ids_json" id="place-ids-input">

      <h3 style="margin-top:32px;">ğŸ—ºï¸ í¬í•¨ëœ ì¥ì†Œ</h3>

      <!-- âœ… form ë°–ì´ì§€ë§Œ submití•  ë•Œ ìˆœì„œ ë°˜ì˜ë¨ -->
      <ol id="sortable-list" style="padding-left: 20px;">
        {% for rp in stops %}
          <li data-place-id="{{ rp.place.id }}" style="margin: 8px 0; cursor: move;">
            <span class="item-label">{{ rp.place.name }}</span>
            <button type="button" class="delete-btn" data-place-id="{{ rp.place.id }}">ì‚­ì œ</button>
          </li>
        {% endfor %}
      </ol>

      <!-- ì €ì¥ ë²„íŠ¼ -->
      <button type="submit" class="submit"><span>ì €ì¥</span></button>
    </form>    
  </div>
</main>

<!-- jQuery, jQuery UI, ì‚¬ìš©ì ìŠ¤í¬ë¦½íŠ¸ -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
<script src="{% static 'js/edit_route.js' %}"></script>
{% endblock %}