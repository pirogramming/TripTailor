{% extends "base.html" %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="{% static 'css/main.css' %}">
<link rel="stylesheet" href="{% static 'css/tag.css' %}">
<form method="get" action="">
    <input
        type="text"
        name="prompt"
        placeholder="ì—¬í–‰ì§€ ì¡°ê±´ì„ ì…ë ¥í•´ë³´ì„¸ìš”!"
        value="{{ prompt }}"
    />
    {% if show_followup %}
    <div>
        <strong>ğŸ¤” {{ question }}</strong>
        <input type="text" name="followup" placeholder="ë‹µë³€ì„ ì…ë ¥í•˜ì„¸ìš”" />
        <button type="submit">
            <svg xmlns="http://www.w3.org/2000/svg" id="Outline" viewBox="0 0 24 24" width="20" height="20"><path d="M23.119.882a2.966,2.966,0,0,0-2.8-.8l-16,3.37a4.995,4.995,0,0,0-2.853,8.481L3.184,13.65a1,1,0,0,1,.293.708v3.168a2.965,2.965,0,0,0,.3,1.285l-.008.007.026.026A3,3,0,0,0,5.157,20.2l.026.026.007-.008a2.965,2.965,0,0,0,1.285.3H9.643a1,1,0,0,1,.707.292l1.717,1.717A4.963,4.963,0,0,0,15.587,24a5.049,5.049,0,0,0,1.605-.264,4.933,4.933,0,0,0,3.344-3.986L23.911,3.715A2.975,2.975,0,0,0,23.119.882ZM4.6,12.238,2.881,10.521a2.94,2.94,0,0,1-.722-3.074,2.978,2.978,0,0,1,2.5-2.026L20.5,2.086,5.475,17.113V14.358A2.978,2.978,0,0,0,4.6,12.238Zm13.971,7.17a3,3,0,0,1-5.089,1.712L11.762,19.4a2.978,2.978,0,0,0-2.119-.878H6.888L21.915,3.5Z"/></svg>
        </button>
    </div>
    {% else %}
    <button type="submit">
        <svg xmlns="http://www.w3.org/2000/svg" id="Outline" viewBox="0 0 24 24" width="40" height="40"><path d="M23.707,22.293l-5.969-5.969a10.016,10.016,0,1,0-1.414,1.414l5.969,5.969a1,1,0,0,0,1.414-1.414ZM10,18a8,8,0,1,1,8-8A8.009,8.009,0,0,1,10,18Z"/></svg>
    </button>
    {% endif %}
</form>

<section class="tag-rail" data-expanded="false">
  <div class="track" id="tagTrack">
    {% for t in tags %}
      <button
        type="button"
        class="chip{% if t.name in selected_tags %} active{% endif %}{% if forloop.counter0 >= 5 %} extra{% endif %}"
        data-tag="{{ t.name }}"
        aria-pressed="{% if t.name in selected_tags %}true{% else %}false{% endif %}">
        #{{ t.name }}
      </button>
    {% endfor %}
  </div>
  <button type="button" class="chip more" aria-expanded="false">+ ë”ë³´ê¸°</button>
</section>

<style>
    .btn {
        display: inline-block;
        padding: 8px 16px;
        margin-right: 8px;
        background: #eee;
        color: #333;
        border-radius: 4px;
        text-decoration: none;
        border: 1px solid #ccc;
    }
    .btn.active {
        background: #007bff;
        color: #fff;
        border-color: #007bff;
    }
</style>
<div class="filter-bar">
  <a href="?{% if prompt %}prompt={{ prompt }}&{% endif %}"
     class="btn {% if not place_class %}active{% endif %}">ì „ì²´</a>
  <a href="?{% if prompt %}prompt={{ prompt }}&{% endif %}place_class=1"
     class="btn {% if place_class == '1' %}active{% endif %}">ë ˆí¬ì¸ </a>
  <a href="?{% if prompt %}prompt={{ prompt }}&{% endif %}place_class=2"
     class="btn {% if place_class == '2' %}active{% endif %}">ì‡¼í•‘</a>
  <a href="?{% if prompt %}prompt={{ prompt }}&{% endif %}place_class=3"
     class="btn {% if place_class == '3' %}active{% endif %}">ê´€ê´‘ì§€</a>
  <a href="?{% if prompt %}prompt={{ prompt }}&{% endif %}place_class=4"
     class="btn {% if place_class == '4' %}active{% endif %}">ë¬¸í™”ì‹œì„¤</a>
</div>
<h2 class="place-section__title">ì „ì²´ ì—¬í–‰ì§€</h2>
<ul class="place-list">
  {% for place in places %}
  <li class="place-item">
    <div class="place-item__head">
      <span class="place-item__name">{{ place.name }}</span>
      <span class="place-item__meta">({{ place.region }}) Â·
        {% if place.place_class == 1 %}ë ˆí¬ì¸ {% elif place.place_class == 2 %}ì‡¼í•‘{% elif place.place_class == 3 %}ê´€ê´‘ì§€{% elif place.place_class == 4 %}ë¬¸í™”ì‹œì„¤{% endif %}
      </span>
      <a class="place-item__link" href="{% url 'places:place_detail' place.pk %}">ìì„¸íˆ ë³´ê¸°</a>
      {% if user.is_authenticated %}
      <form method="post" action="{% url 'places:place_like' place.pk %}" class="like-form">
        {% csrf_token %}
        <button type="submit" class="like-button">
          {% if place.is_liked %}â¤ï¸ ì·¨ì†Œ{% else %}ğŸ¤ ì¢‹ì•„ìš”{% endif %}
        </button>
      </form>
      <button type="button" class="add-to-route-btn" data-place-id="{{ place.id }}">
        â• ë£¨íŠ¸ì— ì¶”ê°€
      </button>
      <!-- ë“œë¡­ë‹¤ìš´ -->
      <div class="route-dropdown" style="display:none; position:absolute; background:#fff; border:1px solid #ccc; padding:.5rem; z-index:10; min-width:200px;">
        <div class="route-list">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
        <hr>
        <div class="create-route-form">
          <input type="text" class="new-route-title" placeholder="ìƒˆ ë£¨íŠ¸ ì œëª©" style="width:100%; margin-bottom:.25rem;">
          <input type="text" class="new-route-summary" placeholder="ë£¨íŠ¸ ìš”ì•½(ì„ íƒ, 200ì ì´ë‚´)" style="width:100%; margin-bottom:.25rem;">
          <label style="display:block; margin-bottom:.25rem;">
            <input type="checkbox" class="new-route-public" checked>ê³µê°œ ë£¨íŠ¸ë¡œ ë§Œë“¤ê¸°
          </label>
          <button type="button" class="create-route-btn">ï¼‹ ìƒˆ ë£¨íŠ¸ ë§Œë“¤ê¸°</button>
        </div>
      </div>
      {% endif %}
    </div>
    <ul class="tag-list">
      {% for tag in place.tags.all %}
      <li class="tag">#{{ tag.name }}</li>
      {% endfor %}
    </ul>
  </li>
  {% endfor %}
</ul>
{% endblock %}
