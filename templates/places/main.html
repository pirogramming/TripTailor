{% extends "base.html" %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="{% static 'css/main.css' %}">

<form method="get" action="">
    <input
        type="text"
        name="prompt"
        placeholder="여행지 조건을 입력해보세요!"
        value="{{ prompt }}"
    />
    <button type="submit">추천받기</button>
</form>

<div class="filter-bar">
  <a href="?{% if prompt %}prompt={{ prompt }}&{% endif %}"
     class="btn {% if not place_class %}active{% endif %}">전체</a>
  <a href="?{% if prompt %}prompt={{ prompt }}&{% endif %}place_class=1"
     class="btn {% if place_class == '1' %}active{% endif %}">레포츠</a>
  <a href="?{% if prompt %}prompt={{ prompt }}&{% endif %}place_class=2"
     class="btn {% if place_class == '2' %}active{% endif %}">쇼핑</a>
  <a href="?{% if prompt %}prompt={{ prompt }}&{% endif %}place_class=3"
     class="btn {% if place_class == '3' %}active{% endif %}">관광지</a>
  <a href="?{% if prompt %}prompt={{ prompt }}&{% endif %}place_class=4"
     class="btn {% if place_class == '4' %}active{% endif %}">문화시설</a>
</div>

<h2 class="place-section__title">전체 여행지</h2>
<ul class="place-list">
  {% for place in places %}
  <li class="place-item">
    <div class="place-item__head">
      <span class="place-item__name">{{ place.name }}</span>
      <span class="place-item__meta">({{ place.region }}) ·
        {% if place.place_class == 1 %}레포츠{% elif place.place_class == 2 %}쇼핑{% elif place.place_class == 3 %}관광지{% elif place.place_class == 4 %}문화시설{% endif %}
      </span>
      <a class="place-item__link" href="{% url 'places:place_detail' place.pk %}">자세히 보기</a>
      {% if user.is_authenticated %}
      <form method="post" action="{% url 'places:place_like' place.pk %}" class="like-form">
        {% csrf_token %}
        <button type="submit" class="like-button">
          {% if place.is_liked %}❤️ 취소{% else %}🤍 좋아요{% endif %}
        </button>
      </form>
      {% endif %}
    </div>

    <ul class="tag-list">
      {% for tag in place.tags.all %}
      <li class="tag">#{{ tag.name }}</li>
      {% endfor %}
    </ul>
  </li>
  {% endfor %}
</ul>
{% endblock %}