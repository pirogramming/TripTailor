{% extends "base.html" %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="{% static 'css/search.css' %}">


<form method="get" action="">
    <input
        type="text"
        name="prompt"
        placeholder="ì—¬í–‰ì§€ ì¡°ê±´ì„ ì…ë ¥í•´ë³´ì„¸ìš”!"
        value="{{ prompt }}"
    />
    {% if show_followup %}
    <div>
        <strong>ğŸ¤” {{ question }}</strong>
        <input type="text" name="followup" placeholder="ë‹µë³€ì„ ì…ë ¥í•˜ì„¸ìš”" />
        <button type="submit">ë³´ì¶© ë‹µë³€ ì œì¶œ</button>
    </div>
    {% else %}
    <button type="submit">ì¶”ì²œë°›ê¸°</button>
    {% endif %}
</form>

{% if recommended_places and not show_followup %}
<h2 class="section-title">ì¶”ì²œ ì—¬í–‰ì§€</h2>

<!-- ì´ˆê¸° 3ê°œ ì¹´ë“œ (ê°€ë¡œ ë°°ì¹˜ ìœ ì§€) -->
<div class="recommend-grid">
    <div class="recommend-list" id="places-container">
        {% for rec in recommended_places %}
        <div class="place-card">
            <div class="place-card__map">
            </div>
            <div class="place-card__body">
                <h3 class="place-card__title">{{ rec.place.name }}</h3>
                <p class="place-card__region">{{ rec.place.region }}</p>
                <p class="place-card__reason">{{ rec.reason }}</p>
                <p class="place-card__summary">{{ rec.place.summary|truncatechars:200|default:"ì„¤ëª… ì—†ìŒ" }}</p>
                <ul class="tag-list">
                    {% for tag in rec.place.tags.all %}
                    <li class="tag">#{{ tag.name }}</li>
                    {% endfor %}
                </ul>
                {% if user.is_authenticated %}
                <form method="post" action="{% url 'places:place_like' rec.place.pk %}" class="like-form">
                    {% csrf_token %}
                    <button type="submit" class="like-button">
                        {% if rec.place.is_liked %}
                            â¤ï¸ ì·¨ì†Œ
                        {% else %}
                            ğŸ¤ ì¢‹ì•„ìš”
                        {% endif %}
                    </button>
                </form>
                {% endif %}
                <a href="{% url 'places:place_detail' rec.place.pk %}" class="link">ìì„¸íˆ ë³´ê¸°</a>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<!-- ì¶”ê°€ë  ì¹´ë“œë“¤ì„ ìœ„í•œ ì„¸ë¡œ ì»¨í…Œì´ë„ˆ -->
<div id="additional-places-container" class="additional-places-container"></div>

<!-- ë”ë³´ê¸° ë²„íŠ¼ -->
<div class="more-places-section" id="more-section">
    <button id="load-more-btn" class="more-places-button" data-prompt="{{ prompt }}" data-followup="{{ followup|default:'' }}">
        ğŸ” ë” ë§ì€ ì¥ì†Œ ë³´ê¸°
    </button>
    <div id="loading" style="display: none; text-align: center; padding: 20px;">
        <p>ì¥ì†Œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
    </div>
</div>
{% endif %}

<a href="{% url 'places:main' %}" class="back-link">â† ë©”ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>




{% endblock %}
